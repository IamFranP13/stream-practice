rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAADB3CAAAAEAAAAAkdAAWaGFyZFxGaW5kQW5hZ3JhbXMuamF2YXQCCSAgICAgICAgcmV0dXJuIHdvcmRzLnN0cmVhbSgpDQogICAgICAgICAgICAgICAgLmNvbGxlY3QoQ29sbGVjdG9ycy5ncm91cGluZ0J5KHdvcmQgLT4gew0KICAgICAgICAgICAgICAgICAgICBjaGFyW10gY2hhcnMgPSB3b3JkLnRvTG93ZXJDYXNlKCkudG9DaGFyQXJyYXkoKTsNCiAgICAgICAgICAgICAgICAgICAgQXJyYXlzLnNvcnQoY2hhcnMpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZyhjaGFycyk7DQogICAgICAgICAgICAgICAgfSkpDQogICAgICAgICAgICAgICAgLmVudHJ5U2V0KCkNCiAgICAgICAgICAgICAgICAuc3RyZWFtKCkNCiAgICAgICAgICAgICAgICAuZmlsdGVyKGVudHJ5IC0+IGVudHJ5LmdldFZhbHVlKCkuc2l6ZSgpID4gMSkNCiAgICAgICAgICAgICAgICAuY29sbGVjdChDb2xsZWN0b3JzLnRvTWFwKA0KICAgICAgICAgICAgICAgICAgICAgICAgTWFwLkVudHJ5OjpnZXRLZXksDQogICAgICAgICAgICAgICAgICAgICAgICBNYXAuRW50cnk6OmdldFZhbHVlKSk7dAAabWVkaXVtXENvdW50RnJlcXVlbmN5LmphdmF0AF4gICAgICAgIHJldHVybiBudW1iZXJzLnN0cmVhbSgpLmNvbGxlY3QoZ3JvdXBpbmdCeShJbnRlZ2VyOjppbnRWYWx1ZSwgQ29sbGVjdG9ycy5jb3VudGluZygpKSk7dAAVZWFzeVxTb3J0TnVtYmVycy5qYXZhdABEICAgICAgICByZXR1cm4gbnVtYmVycy5zdHJlYW0oKQ0KICAgICAgICAgICAgICAgIC5zb3J0ZWQoKS50b0xpc3QoKTt0ABpoYXJkXE1lcmdlU29ydGVkTGlzdHMuamF2YXQAgiAgICAgICAgcmV0dXJuIHNvcnRlZExpc3RzLnN0cmVhbSgpDQogICAgICAgICAgICAgICAgLmZsYXRNYXAoTGlzdDo6c3RyZWFtKQ0KICAgICAgICAgICAgICAgIC5zb3J0ZWQoKQ0KICAgICAgICAgICAgICAgIC50b0xpc3QoKTt0ABJlYXN5XE5vbmVaZXJvLmphdmF0AEMgICAgICAgIHJldHVybiBudW1iZXJzLnN0cmVhbSgpLm5vbmVNYXRjaChpbnRlZ2VyIC0+IGludGVnZXIgPT0gMCk7dAAebWVkaXVtXEZpbHRlckFuZFRyYW5zZm9ybS5qYXZhdABtICAgICAgICByZXR1cm4gbnVtYmVycy5zdHJlYW0oKS5maWx0ZXIoaW50ZWdlciAtPiBpbnRlZ2VyID49IG1pbiAmJiBpbnRlZ2VyIDw9IG1heCkubWFwKGUgLT4gZSAqIGUpLnRvTGlzdCgpO3QAFmVhc3lcRmxhdHRlbkxpc3RzLmphdmF0AD0gICAgICAgIHJldHVybiBsaXN0cy5zdHJlYW0oKS5mbGF0TWFwKExpc3Q6OnN0cmVhbSkudG9MaXN0KCk7dAAdaGFyZFxNb3N0RnJlcXVlbnRFbGVtZW50LmphdmF0AVsgICAgICAgIGlmIChudW1iZXJzLmlzRW1wdHkoKSkgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbnVtYmVycy5zdHJlYW0oKQ0KICAgICAgICAgICAgICAgIC5jb2xsZWN0KENvbGxlY3RvcnMuZ3JvdXBpbmdCeShuIC0+IG4sIENvbGxlY3RvcnMuY291bnRpbmcoKSkpDQogICAgICAgICAgICAgICAgLmVudHJ5U2V0KCkuc3RyZWFtKCkNCiAgICAgICAgICAgICAgICAubWF4KE1hcC5FbnRyeS5jb21wYXJpbmdCeVZhbHVlKCkpDQogICAgICAgICAgICAgICAgLm1hcChNYXAuRW50cnk6OmdldEtleSkNCiAgICAgICAgICAgICAgICAub3JFbHNlKG51bGwpO3QAG2Vhc3lcUGFydGl0aW9uQnlQYXJpdHkuamF2YXQAVCAgICAgICAgcmV0dXJuIG51bWJlcnMuc3RyZWFtKCkuY29sbGVjdChDb2xsZWN0b3JzLnBhcnRpdGlvbmluZ0J5KG4gLT4gbiAlIDIgPT0gMCkpO3QAGWhhcmRcVHJhbnNwb3NlTWF0cml4LmphdmF0AXogICAgICAgIGlmIChtYXRyaXguaXNFbXB0eSgpKSB7DQogICAgICAgICAgICByZXR1cm4gTGlzdC5vZigpOw0KICAgICAgICB9DQoNCiAgICAgICAgaW50IHJvd3MgPSBtYXRyaXguc2l6ZSgpOw0KICAgICAgICBpbnQgY29scyA9IG1hdHJpeC5nZXQoMCkuc2l6ZSgpOw0KDQogICAgICAgIHJldHVybiBJbnRTdHJlYW0ucmFuZ2UoMCwgY29scykNCiAgICAgICAgICAgICAgICAubWFwVG9PYmooYyAtPiBJbnRTdHJlYW0ucmFuZ2UoMCwgcm93cykNCiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXBUb09iaihyIC0+IG1hdHJpeC5nZXQocikuZ2V0KGMpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgLnRvTGlzdCgpKQ0KICAgICAgICAgICAgICAgIC50b0xpc3QoKTt0ABplYXN5XEF2ZXJhZ2VPZk51bWJlcnMuamF2YXQARiAgICAgICAgcmV0dXJuIG51bWJlcnMuc3RyZWFtKCkubWFwVG9JbnQoSW50ZWdlcjo6aW50VmFsdWUpLmF2ZXJhZ2UoKTt0ABVlYXN5XEFsbFBvc2l0aXZlLmphdmF0AEcgICAgICAgIHJldHVybiBudW1iZXJzLnN0cmVhbSgpDQogICAgICAgICAgICAgICAgLmFsbE1hdGNoKG4gLT4gbiA+IDApO3QAGGVhc3lcRmlyc3RORWxlbWVudHMuamF2YXQARCAgICAgICAgcmV0dXJuIG51bWJlcnMuc3RyZWFtKCkNCiAgICAgICAgICAgICAgICAubGltaXQobikudG9MaXN0KCk7dAAXZWFzeVxTcXVhcmVOdW1iZXJzLmphdmF0AEsgICAgICAgIHJldHVybiBudW1iZXJzLnN0cmVhbSgpDQogICAgICAgICAgICAgICAgLm1hcChuIC0+IG4gKiBuKS50b0xpc3QoKTt0ABRlYXN5XFN1bU51bWJlcnMuamF2YXQAZiAgICAgICAgcmV0dXJuIG51bWJlcnMuc3RyZWFtKCkNCiAgICAgICAgICAgICAgICAubWFwVG9JbnQoSW50ZWdlcjo6aW50VmFsdWUpDQogICAgICAgICAgICAgICAgLnN1bSgpO3QAG2Vhc3lcRmlsdGVyRXZlbk51bWJlcnMuamF2YXQAZSAgICAgICAgcmV0dXJuIG51bWJlcnMuc3RyZWFtKCkNCiAgICAgICAgICAgICAgICAuZmlsdGVyKG4gLT4gbiAlIDIgPT0gMCkNCiAgICAgICAgICAgICAgICAudG9MaXN0KCk7dAARZWFzeVxGaW5kTWluLmphdmF0ADYgICAgICAgIHJldHVybiBudW1iZXJzLnN0cmVhbSgpLm1pbihJbnRlZ2VyOjpjb21wYXJlKTt0ABloYXJkXEdyb3VwU3RhdGlzdGljcy5qYXZhdAFEICAgICAgICByZXR1cm4gbnVtYmVycy5zdHJlYW0oKQ0KICAgICAgICAgICAgICAgIC5jb2xsZWN0KENvbGxlY3RvcnMucGFydGl0aW9uaW5nQnkoDQogICAgICAgICAgICAgICAgICAgICAgICBuIC0+IChuICYgMSkgPT0gMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIENvbGxlY3RvcnMuY29sbGVjdGluZ0FuZFRoZW4oDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbGxlY3RvcnMuc3VtbWFyaXppbmdJbnQoSW50ZWdlcjo6aW50VmFsdWUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHcm91cFN0YXRpc3RpY3M6OnRvU3RhdHMpKSk7dAAUaGFyZFxSdW5uaW5nU3VtLmphdmF0ARUgICAgICAgIGludCBuID0gbnVtYmVycy5zaXplKCk7DQoNCiAgICAgICAgaW50W10gcHJlZml4ID0gbmV3IGludFtuICsgMV07DQogICAgICAgIEludFN0cmVhbS5yYW5nZSgwLCBuKS5mb3JFYWNoKGkgLT4gcHJlZml4W2kgKyAxXSA9IHByZWZpeFtpXSArIG51bWJlcnMuZ2V0KGkpKTsNCg0KICAgICAgICByZXR1cm4gSW50U3RyZWFtLnJhbmdlKDAsIG4pDQogICAgICAgICAgICAgICAgLm1hcFRvT2JqKGkgLT4gcHJlZml4W2kgKyAxXSkNCiAgICAgICAgICAgICAgICAudG9MaXN0KCk7dAAXbWVkaXVtXFVuaXF1ZVdvcmRzLmphdmF0ANggICAgICAgIHJldHVybiBzZW50ZW5jZXMuc3RyZWFtKCkuZmxhdE1hcChzZW50ZW5jZSAtPiBBcnJheXMuc3RyZWFtKHNlbnRlbmNlLnNwbGl0KCIgIikpKQ0KICAgICAgICAgICAgICAgIC5tYXAoU3RyaW5nOjp0b0xvd2VyQ2FzZSkNCiAgICAgICAgICAgICAgICAuZGlzdGluY3QoKQ0KICAgICAgICAgICAgICAgIC5zb3J0ZWQoKQ0KICAgICAgICAgICAgICAgIC50b0xpc3QoKTt0ABFlYXN5XEZpbmRNYXguamF2YXQASiAgICAgICAgcmV0dXJuIG51bWJlcnMuc3RyZWFtKCkNCiAgICAgICAgICAgICAgICAubWF4KEludGVnZXI6OmNvbXBhcmVUbyk7dAAaZWFzeVxQcm9kdWN0T2ZOdW1iZXJzLmphdmF0AEogICAgICAgIHJldHVybiBudW1iZXJzLnN0cmVhbSgpLnJlZHVjZSgoYWNjLCBudW0pIC0+IGFjYyAqIG51bSkub3JFbHNlKDEpO3QAF21lZGl1bVxUb3BOTGFyZ2VzdC5qYXZhdABUICAgICAgICByZXR1cm4gbnVtYmVycy5zdHJlYW0oKS5zb3J0ZWQoQ29tcGFyYXRvci5yZXZlcnNlT3JkZXIoKSkubGltaXQobikudG9MaXN0KCk7dAAXZWFzeVxGaW5kRmlyc3RFdmVuLmphdmF0AEQgICAgICAgIHJldHVybiBudW1iZXJzLnN0cmVhbSgpLmZpbHRlcihlIC0+IGUgJSAyID09IDApLmZpbmRGaXJzdCgpO3QAHW1lZGl1bVxGaWJvbmFjY2lTZXF1ZW5jZS5qYXZhdACvICAgICAgICByZXR1cm4gU3RyZWFtLml0ZXJhdGUobmV3IGludFtdIHsgMCwgMSB9LCBlIC0+IG5ldyBpbnRbXSB7IGVbMV0sIGVbMF0gKyBlWzFdIH0pDQogICAgICAgICAgICAgICAgLm1hcChlIC0+IGVbMF0pDQogICAgICAgICAgICAgICAgLmxpbWl0KG4pDQogICAgICAgICAgICAgICAgLnRvTGlzdCgpO3QAH21lZGl1bVxEaXN0aW5jdEFuZFNvcnREZXNjLmphdmF0AFYgICAgICAgIHJldHVybiBudW1iZXJzLnN0cmVhbSgpLmRpc3RpbmN0KCkuc29ydGVkKENvbXBhcmF0b3IucmV2ZXJzZU9yZGVyKCkpLnRvTGlzdCgpO3QAFWVhc3lcQW55TmVnYXRpdmUuamF2YXQANSAgICAgICAgcmV0dXJuIG51bWJlcnMuc3RyZWFtKCkuYW55TWF0Y2gobiAtPiBuIDwgMCk7dAAZaGFyZFxHcm91cEJ5RGlnaXRTdW0uamF2YXQAbCAgICAgICAgcmV0dXJuIG51bWJlcnMuc3RyZWFtKCkNCiAgICAgICAgICAgICAgICAuY29sbGVjdChDb2xsZWN0b3JzLmdyb3VwaW5nQnkoR3JvdXBCeURpZ2l0U3VtOjpkaWdpdFN1bSkpO3QAGmhhcmRcRmluZFBhaXJzV2l0aFN1bS5qYXZhdAIuICAgICAgICBpbnQgbiA9IG51bWJlcnMuc2l6ZSgpOw0KDQogICAgICAgIHJldHVybiBJbnRTdHJlYW0ucmFuZ2UoMCwgbikNCiAgICAgICAgICAgICAgICAuYm94ZWQoKQ0KICAgICAgICAgICAgICAgIC5mbGF0TWFwKGkgLT4gSW50U3RyZWFtLnJhbmdlKGkgKyAxLCBuKQ0KICAgICAgICAgICAgICAgICAgICAgICAgLm1hcFRvT2JqKGogLT4gTGlzdC5vZihudW1iZXJzLmdldChpKSwgbnVtYmVycy5nZXQoaikpKSkNCiAgICAgICAgICAgICAgICAuZmlsdGVyKHBhaXIgLT4gcGFpci5nZXQoMCkgKyBwYWlyLmdldCgxKSA9PSB0YXJnZXQpDQogICAgICAgICAgICAgICAgLm1hcChwYWlyIC0+IHsNCiAgICAgICAgICAgICAgICAgICAgaW50IGEgPSBwYWlyLmdldCgwKTsNCiAgICAgICAgICAgICAgICAgICAgaW50IGIgPSBwYWlyLmdldCgxKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgPD0gYiA/IHBhaXIgOiBMaXN0Lm9mKGIsIGEpOw0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgLmRpc3RpbmN0KCkNCiAgICAgICAgICAgICAgICAudG9MaXN0KCk7dAAXZWFzeVxHcm91cEJ5TGVuZ3RoLmphdmF0AE8gICAgICAgIHJldHVybiBzdHJpbmdzLnN0cmVhbSgpLmNvbGxlY3QoQ29sbGVjdG9ycy5ncm91cGluZ0J5KFN0cmluZzo6bGVuZ3RoKSk7dAAaZWFzeVxSZW1vdmVEdXBsaWNhdGVzLmphdmF0AEYgICAgICAgIHJldHVybiBudW1iZXJzLnN0cmVhbSgpDQogICAgICAgICAgICAgICAgLmRpc3RpbmN0KCkudG9MaXN0KCk7dAAXbWVkaXVtXFN1bUJ5UGFyaXR5LmphdmF0AJwgICAgICAgIHJldHVybiBudW1iZXJzLnN0cmVhbSgpLmNvbGxlY3QoDQogICAgICAgICAgICAgICAgQ29sbGVjdG9ycy5wYXJ0aXRpb25pbmdCeShpbnRlZ2VyIC0+IGludGVnZXIgJSAyID09IDAsIENvbGxlY3RvcnMuc3VtbWluZ0ludChJbnRlZ2VyOjppbnRWYWx1ZSkpKTt0ABltZWRpdW1cTG9uZ2VzdFN0cmluZy5qYXZhdABNICAgICAgICByZXR1cm4gc3RyaW5ncy5zdHJlYW0oKS5tYXgoQ29tcGFyYXRvci5jb21wYXJpbmdJbnQoU3RyaW5nOjpsZW5ndGgpKTt0ABplYXN5XENvdW50R3JlYXRlclRoYW4uamF2YXQAZyAgICAgICAgcmV0dXJuIG51bWJlcnMuc3RyZWFtKCkNCiAgICAgICAgICAgICAgICAuZmlsdGVyKG4gLT4gbiA+IHRocmVzaG9sZCkNCiAgICAgICAgICAgICAgICAuY291bnQoKTt0ABVlYXN5XFRvVXBwZXJDYXNlLmphdmF0AFQgICAgICAgIHJldHVybiBzdHJpbmdzLnN0cmVhbSgpDQogICAgICAgICAgICAgICAgLm1hcChTdHJpbmc6OnRvVXBwZXJDYXNlKS50b0xpc3QoKTt0ABZlYXN5XFNraXBFbGVtZW50cy5qYXZhdAAxICAgICAgICByZXR1cm4gbnVtYmVycy5zdHJlYW0oKS5za2lwKG4pLnRvTGlzdCgpO3g=